# Vulnerability Scanning

Methodology for proactive vulnerability scanning of the repository codebase.

## Scanning Approach

### Phase 1: Reconnaissance
1. Identify the project's language(s) and ecosystem(s)
2. Map the attack surface â€” which components handle untrusted input?
3. Identify entry points (network handlers, file parsers, CLI input)
4. Check `.github/ecosystems/` for ecosystem-specific vulnerability patterns

### Phase 2: Static Analysis (Manual)
1. Search for dangerous function patterns (see `shared/dangerous-patterns.md`)
2. Trace data flow from entry points to sensitive operations
3. Check error handling completeness
4. Review configuration files for insecure defaults

### Phase 3: Dependency Audit
1. List all dependencies and their versions
2. Check for known CVEs using:
   ```bash
   # GitHub's built-in advisory database
   gh api repos/{owner}/{repo}/dependabot/alerts --jq '.[].security_advisory.cve_id'
   ```
3. Cross-reference with ecosyste.ms for maintenance status
4. Flag abandoned or undermaintained dependencies

### Phase 4: Supply Chain
1. Verify dependency sources (official registries only)
2. Check for pinned versions vs floating ranges
3. Look for post-install scripts in dependencies
4. Verify integrity mechanisms (lock files, checksums)

## CWE Reference

Common Weakness Enumeration categories to check:

| CWE | Name | What to Look For |
|-----|------|-----------------|
| CWE-120 | Buffer Copy without Size Check | `strcpy`, `memcpy` without bounds |
| CWE-125 | Out-of-bounds Read | Array access without bounds check |
| CWE-190 | Integer Overflow | Arithmetic before allocation size |
| CWE-416 | Use After Free | Pointer use after `free()` |
| CWE-476 | NULL Pointer Dereference | Missing NULL checks |
| CWE-78 | OS Command Injection | `system()`, `exec()` with user input |
| CWE-89 | SQL Injection | String concat in SQL queries |
| CWE-22 | Path Traversal | File ops with user-controlled paths |
| CWE-327 | Broken Crypto | Weak algorithms, custom crypto |
| CWE-798 | Hardcoded Credentials | Passwords/keys in source |
| CWE-502 | Deserialization | `pickle`, `Marshal`, `ObjectInputStream` |
| CWE-400 | Resource Exhaustion | Unbounded allocation/loop |

## Finding Format

For each vulnerability found during scanning:

```json
{
  "id": "SCAN-001",
  "cwe": "CWE-120",
  "severity": "high",
  "title": "Buffer overflow in input parser",
  "file": "src/parser.c",
  "line_range": "142-155",
  "description": "The parse_header function copies user input into a fixed-size stack buffer without bounds checking.",
  "impact": "An attacker could achieve remote code execution by sending a crafted input.",
  "recommendation": "Use snprintf() or a dynamically-sized buffer with explicit length checks.",
  "evidence": "Line 148: strcpy(header_buf, input); // header_buf is char[256], input is unbounded"
}
```

## Scan Results Summary

After completing a scan, summarize:

```markdown
## Security Scan Results - [DATE]

### Summary
- Files scanned: N
- Findings: X (Y critical, Z high, W medium, V low)
- Dependencies checked: N
- CVEs found: N

### Critical/High Findings
1. [Finding details]

### Recommendations
- [Prioritized list of actions]
```
